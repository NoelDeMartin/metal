#!/bin/bash

if [ -z "$METAL_HOME" ]
then
    echo "METAL_HOME env variable not set"
    exit
fi

COMMAND=$1

OPTIONS=`getopt --longoptions=debug --name "$0" -- "$@"`
eval set -- "$OPTIONS"
while true; do
    case "$1" in
        -d|--debug)
            export METAL_DEBUG=true
            shift
            ;;
        --)
            shift
            break
            ;;
        *)
            echo "Programming error"
            exit 3
            ;;
    esac
done

export PROJECT_PATH=`pwd`

case $COMMAND in
    "build")
        bash "$METAL_HOME/src/build.sh"
        ;;
    "up")
        bash "$METAL_HOME/src/up.sh"
        ;;
    "down")
        bash "$METAL_HOME/src/down.sh"
        ;;
    "shell")
        bash "$METAL_HOME/src/shell.sh"
        ;;
    "logs")
        bash "$METAL_HOME/src/logs.sh"
        ;;
    *)
        echo "Unknown command \"$1\""
        ;;
esac
